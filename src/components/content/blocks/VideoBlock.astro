---
export interface Props {
  block: {
    content: string;
    videoType: 'YOUTUBE' | 'VIMEO';
    videoId: string;
    videoTitle?: string;
  };
}

const { block } = Astro.props;

// Function to get embed URL based on video type
function getEmbedUrl(videoType: string, videoId: string): string {
  switch (videoType) {
    case 'YOUTUBE':
      return `https://www.youtube.com/embed/${videoId}`;
    case 'VIMEO':
      return `https://player.vimeo.com/video/${videoId}`;
    default:
      return '';
  }
}

const embedUrl = getEmbedUrl(block.videoType, block.videoId);
---

<div class="not-prose my-8">
  <!-- Video Container with 16:9 aspect ratio -->
  <div class="relative aspect-video w-full rounded-lg overflow-hidden shadow-lg bg-gray-100">
    <iframe
      src={embedUrl}
      title={block.videoTitle || 'Video'}
      frameborder="0"
      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
      allowfullscreen
      class="absolute inset-0 w-full h-full"
      loading="lazy"
    ></iframe>
  </div>
  
  <!-- Video Caption/Description -->
  {(block.videoTitle || block.content) && (
    <div class="mt-4 text-center">
      {block.videoTitle && (
        <h4 class="text-lg font-semibold text-gray-900 mb-2">
          {block.videoTitle}
        </h4>
      )}
      {block.content && (
        <p class="text-sm text-gray-600 italic">
          {block.content}
        </p>
      )}
    </div>
  )}
</div>